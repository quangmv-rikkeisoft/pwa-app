import{a as F,O as k,P as W,g as C,B as _,F as A,j as b}from"./index.d0054462.js";import{M as I}from"./Meta.74fc75d3.js";import{F as T}from"./App.a11b1fbf.js";import"./index.module.92ed0f1f.js";import"./index.b8cd7070.js";var j={exports:{}};(function(M,w){(function(m,g){M.exports=g(F.exports)})(k,function(O){return function(m){var g={};function u(n){if(g[n])return g[n].exports;var a=g[n]={i:n,l:!1,exports:{}};return m[n].call(a.exports,a,a.exports,u),a.l=!0,a.exports}return u.m=m,u.c=g,u.d=function(n,a,p){u.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:p})},u.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},u.t=function(n,a){if(a&1&&(n=u(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var p=Object.create(null);if(u.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var S in n)u.d(p,S,function(U){return n[U]}.bind(null,S));return p},u.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(a,"a",a),a},u.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},u.p="",u(u.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(m,g,u){u.r(g);var n=u("react"),a=function(){var f=function(o,e){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},f(o,e)};return function(o,e){f(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),p=function(){return p=Object.assign||function(f){for(var o,e=1,t=arguments.length;e<t;e++){o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(f[i]=o[i])}return f},p.apply(this,arguments)},S=function(f,o){var e={};for(var t in f)Object.prototype.hasOwnProperty.call(f,t)&&o.indexOf(t)<0&&(e[t]=f[t]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(f);i<t.length;i++)o.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(f,t[i])&&(e[t[i]]=f[t[i]]);return e};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(o){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return e?new Promise(function(t,i){e.call(navigator,o,t,i)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function U(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var x=function(f){a(o,f);function o(e){var t=f.call(this,e)||this;return t.canvas=null,t.ctx=null,t.requestUserMediaId=0,t.unmounted=!1,t.state={hasUserMedia:!1},t}return o.prototype.componentDidMount=function(){var e=this,t=e.state,i=e.props;if(this.unmounted=!1,!U()){i.onUserMediaError("getUserMedia not supported");return}t.hasUserMedia||this.requestUserMedia(),i.children&&typeof i.children!="function"&&console.warn("children must be a function")},o.prototype.componentDidUpdate=function(e){var t=this.props;if(!U()){t.onUserMediaError("getUserMedia not supported");return}var i=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),l=e.minScreenshotWidth!==t.minScreenshotWidth,c=e.minScreenshotHeight!==t.minScreenshotHeight;(r||l||c)&&(this.canvas=null,this.ctx=null),(i||r)&&(this.stopAndCleanup(),this.requestUserMedia())},o.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},o.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},o.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(o.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},o.prototype.getScreenshot=function(e){var t=this,i=t.state,r=t.props;if(!i.hasUserMedia)return null;var l=this.getCanvas(e);return l&&l.toDataURL(r.screenshotFormat,r.screenshotQuality)},o.prototype.getCanvas=function(e){var t=this,i=t.state,r=t.props;if(!this.video||!i.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var l=this.video.videoWidth,c=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var s=l/c;l=r.minScreenshotWidth||this.video.clientWidth,c=l/s,r.minScreenshotHeight&&c<r.minScreenshotHeight&&(c=r.minScreenshotHeight,l=c*s)}this.canvas=document.createElement("canvas"),this.canvas.width=(e==null?void 0:e.width)||l,this.canvas.height=(e==null?void 0:e.height)||c,this.ctx=this.canvas.getContext("2d")}var v=this,h=v.ctx,d=v.canvas;return h&&d&&(d.width=(e==null?void 0:e.width)||d.width,d.height=(e==null?void 0:e.height)||d.height,r.mirrored&&(h.translate(d.width,0),h.scale(-1,1)),h.imageSmoothingEnabled=r.imageSmoothing,h.drawImage(this.video,0,0,(e==null?void 0:e.width)||d.width,(e==null?void 0:e.height)||d.height),r.mirrored&&(h.scale(-1,1),h.translate(-d.width,0))),d},o.prototype.requestUserMedia=function(){var e=this,t=this.props,i=function(c,s){var v={video:typeof s<"u"?s:!0};t.audio&&(v.audio=typeof c<"u"?c:!0),e.requestUserMediaId++;var h=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(v).then(function(d){e.unmounted||h!==e.requestUserMediaId?o.stopMediaStream(d):e.handleUserMedia(null,d)}).catch(function(d){e.handleUserMedia(d)})};if("mediaDevices"in navigator)i(t.audioConstraints,t.videoConstraints);else{var r=function(c){return{optional:[{sourceId:c}]}},l=function(c){var s=c.deviceId;return typeof s=="string"?s:Array.isArray(s)&&s.length>0?s[0]:typeof s=="object"&&s.ideal?s.ideal:null};MediaStreamTrack.getSources(function(c){var s=null,v=null;c.forEach(function(y){y.kind==="audio"?s=y.id:y.kind==="video"&&(v=y.id)});var h=l(t.audioConstraints);h&&(s=h);var d=l(t.videoConstraints);d&&(v=d),i(r(s),r(v))})}},o.prototype.handleUserMedia=function(e,t){var i=this.props;if(e||!t){this.setState({hasUserMedia:!1}),i.onUserMediaError(e);return}this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}i.onUserMedia(t)},o.prototype.render=function(){var e=this,t=this,i=t.state,r=t.props,l=r.audio;r.forceScreenshotSourceSize,r.onUserMedia,r.onUserMediaError,r.screenshotFormat,r.screenshotQuality,r.minScreenshotWidth,r.minScreenshotHeight,r.audioConstraints,r.videoConstraints,r.imageSmoothing;var c=r.mirrored,s=r.style,v=s===void 0?{}:s,h=r.children,d=S(r,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),y=c?p(p({},v),{transform:(v.transform||"")+" scaleX(-1)"}):v,E={getScreenshot:this.getScreenshot.bind(this)};return n.createElement(n.Fragment,null,n.createElement("video",p({autoPlay:!0,src:i.src,muted:!l,playsInline:!0,ref:function(P){e.video=P},style:y},d)),h&&h(E))},o.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},o}(n.Component);g.default=x},react:function(m,g){m.exports=O}}).default})})(j);const q=W(j.exports),R={width:1280,height:720,facingMode:"user"};function N(){const M=C.useRef(null),w=C.useCallback(()=>{M.current.getScreenshot()},[M]);return _(A,{children:[b(I,{title:"page 3"}),_(T,{children:[b(q,{audio:!1,height:720,screenshotFormat:"image/jpeg",width:1280,videoConstraints:R,ref:M}),b("button",{onClick:w,children:"Capture photo"})]})]})}export{N as default};
